\documentclass[11pt,letterpaper,]{article}

% Define University of Alberta official colors
\usepackage[dvinames]{xcolor}
\definecolor{UAgreen}{HTML}{007C41}
\definecolor{UAgold}{HTML}{FFDB05}

% Measurements should be taken directly from the guide and need more scrutiny
% https://www.ualberta.ca/toolkit/visual-identity/stationery/letterhead.html
\usepackage[includehead, top=1.55cm,left=2.75cm,bottom=2.25cm,right=2.75cm, footskip=24pt, headsep=0pt, headheight=48pt, heightrounded]{geometry}
\usepackage{graphicx}
\usepackage{hyperref}
\hypersetup{unicode=true,
colorlinks=true,
            linkcolor= blue ,
            citecolor=blue,
            urlcolor=blue,
            breaklinks=true, bookmarks=true}
\urlstyle{same}  % don't use monospace font for urls
\usepackage[absolute]{textpos}
\usepackage{ifthen}
\usepackage{soul}
\usepackage{fontawesome}

% --- For placement of the horizontal line
\usepackage{tikz}
\usetikzlibrary{calc}

% --- A nice serif font (palatino), but not the prescribed nonfree ITC stone
\usepackage[sc,osf]{mathpazo}
\linespread{1.05}

% Remove paragraph indentation
\parindent0pt
\setlength{\parskip}{0.8\baselineskip}
\raggedright
\pagestyle{empty}
% Ensure consistency in the footer
% \urlstyle{sf} % potential conflict

% Sender data: from...
% I can't think of a better way to do this: Choose to supply an icon
% \ifx\true\fabcond  \providecommand\fromtel{\faPhone \hspace{1 mm} 555-555-5555}  \else  \providecommand\fromtel{555-555-5555}  \fi

\def\true{true} \def\fabcond{true} \def\false{false}

 \providecommand\fromname{Brian V. Rusk} 
 \providecommand\fromtitle{associate professor} 
 \providecommand\fromdegree{MA} 
 \providecommand\fromaddress{3-27 Assiniboia Hall,\\
\hfill Edmonton, AB, Canada T6G 2E7} 
 \providecommand\fromdept{department of linguistics} 
 \providecommand\fromfaculty{faculty of arts} 
\ifx\true\fabcond  \providecommand\fromtel{\faPhone \hspace{1 mm} 555-555-5555}  \else  \providecommand\fromtel{555-555-5555}  \fi
\ifx\true\fabcond  \providecommand\fromfax{\faFax \hspace{1 mm} 555-555-5555}  \else  \providecommand\fromfax{555-555-5555}  \fi
\ifx\true\fabcond  \providecommand\fromemail{\faEnvelopeO \hspace{1 mm} \href{mailto:}{\href{mailto:brian.rusk@gmail.com}{\nolinkurl{brian.rusk@gmail.com}}}}  \else  \providecommand\fromemail{\href{mailto:brian.rusk@gmail.com}{\nolinkurl{brian.rusk@gmail.com}}}  \fi
\ifx\true\fabcond  \providecommand\fromweb{\faGlobe \hspace{1 mm} \href{https://brianvrusk.rbind.io}{brianvrusk.rbind.io}}  \else  \providecommand\fromweb{\href{https://brianvrusk.rbind.io}{brianvrusk.rbind.io}}  \fi
 \providecommand\signaturefile{signatureFile} 

% Recipient data: to...
 \providecommand\toname{Jane Smith} 
 \providecommand\toaddress{her street,\\
her city,\\
her country} 

% Letter parts:
 \providecommand\opening{To whom \dots} 
 \providecommand\closing{Best Wishes} 
% \providecommand\logofile{-COLOUR}
 \providecommand\logofile{UA-COLOUR} 
% \providecommand\enclosure{}
% 

% Header and footer
\usepackage{fancyhdr}
\pagestyle{fancy}

\renewcommand{\footrulewidth}{0pt}
\fancyfoot{}
\fancyfoot[R]{%
    \textcolor{UAgreen}{\rule[10pt]{\textwidth}{1.5pt}} \\
    {\footnotesize\color{UAgreen}\sffamily \thepage\ of \pageref*{LastPage}}}

    %\hrule{} % https://tex.stackexchange.com/questions/371286/draw-a-horizontal-line-in-latex

\fancyhead{}
\fancyhead[L]{%
    \textcolor{UAgreen}{\rule[-24pt]{\textwidth}{1.5pt}} \\
    \begin{textblock*}{7cm}[0.3066,0.39](4cm,1.7cm)
        \includegraphics[width=7cm]{\logofile}
    \end{textblock*}
    \begin{textblock*}{15cm}(3.75cm,1.75cm)   % 6.375=8.5 - 1.5 - 0.625
        \sffamily
        \hfill \color{black} \large \MakeUppercase{\fromfaculty}
        \\ \hfill \MakeUppercase{\fromdept}
    \end{textblock*}}
\renewcommand{\headrulewidth}{0pt}

\AtBeginDocument{
    % Text lines should be less than 6in long

    \vspace*{3cm}

    \begin{textblock*}{15cm}(3.75cm,3.1cm)   % 6.375=8.5 - 1.5 - 0.625
        \sffamily
        \hfill \color{black} \hfill \fromname, \fromdegree \\
        \hfill \fromaddress \\
        \hfill \fromtel \\
        \hfill \fromfax \\
        \hfill \fromemail \\
        \hfill \fromweb \\
    \end{textblock*}

    \date
    \bigskip

    \toname\ifthenelse{\equal{\toname}{}}{}{\\}
    \toaddress
    \bigskip

    \opening\par}

\AtEndDocument{
    \par\vspace{2ex}
    \closing,

    \ifthenelse{\equal{\signaturefile}{}}{\bigskip\bigskip}{\includegraphics[width=3cm]{\signaturefile}\\[-0.2\baselineskip]}

    \fromname \\
    \fromtitle\ifthenelse{\equal{\fromtitle}{}}{}{\\}
    % \enclosure
    \label{LastPage}}

% \usepackage{lipsum}

\begin{document}

-- Write your letter here --

% \lipsum[1-5]

\end{document}
